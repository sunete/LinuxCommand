
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <meta name="description" content="jq:一个灵活的轻量级命令行JSON处理器 - 最专业的Linux命令大全，内容包含Linux命令手册、详解、学习，值得收藏的Linux命令速查手册。">
    <meta name="keywords" content="Linux,Command,命令大全,Linux命令手册,jq,一个灵活的轻量级命令行JSON处理器">
    <title>jq 命令，Linux jq 命令详解：一个灵活的轻量级命令行JSON处理器 -  Linux 命令搜索引擎</title>
    <link rel="shortcut icon" href="../img/favicon.ico">
    <link rel="stylesheet" type="text/css" href="../css/index.css?v=1628823324861">
</head>
<body>

<div class="header header_list">
    <div class="search">
        <ul class="search-list" id="result">
            <!-- <li><a href="#"><strong>find</strong> - 指定目录下查找文件。</a></li> -->
        </ul>
        <input type="text" class="query" id="query" autocomplete="off" autofocus="autofocus" placeholder="Linux 命令搜索"/>
        <div class="enter-input">
            <input type="hidden" id="current_path" value="/c/jq.html">
            <button id="search_btn">搜索</button>
        </div>
    </div>
</div>

<div class="markdown-body">

<span class="edit_btn">

<span class="split"></span>

</span>

<h1 id="jq"><a href="#jq" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>jq</h1>
<p>一个灵活的轻量级命令行JSON处理器</p>
<h3 id="补充说明"><a href="#%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>补充说明</h3>
<p>jq 是 stedolan 开发的一个轻量级的和灵活的命令行JSON处理器，源码请参考 <a href="https://github.com/stedolan/jq">jq 项目主页</a></p>
<p>jq 用于处理JSON输入，将给定过滤器应用于其JSON文本输入并在标准输出上将过滤器的结果生成为JSON。</p>
<p>最简单的过滤器是<code>.</code>，它将jq的输入未经修改地复制到其输出中（格式设置除外）。</p>
<p>请注意，jq 当前仅支持64位双精度浮点数（IEEE754）。</p>
<h3 id="安装"><a href="#%E5%AE%89%E8%A3%85" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>安装</h3>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Debian系，如 Ubuntu</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> jq

<span class="token comment"># RedHat系, 如 CentOS</span>
yum <span class="token function">install</span> jq
</code></pre>
<h3 id="语法"><a href="#%E8%AF%AD%E6%B3%95" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>语法</h3>
<pre class="language-bash"><code class="language-bash">jq <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&#x3C;</span>jq filter<span class="token operator">></span> <span class="token punctuation">[</span>file<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
jq <span class="token punctuation">[</span>options<span class="token punctuation">]</span> --args <span class="token operator">&#x3C;</span>jq filter<span class="token operator">></span> <span class="token punctuation">[</span>strings<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
jq <span class="token punctuation">[</span>options<span class="token punctuation">]</span> --jsonargs <span class="token operator">&#x3C;</span>jq filter<span class="token operator">></span> <span class="token punctuation">[</span>JSON_TEXTS<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre>
<h3 id="选项"><a href="#%E9%80%89%E9%A1%B9" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>选项</h3>
<pre class="language-bash"><code class="language-bash">-c               紧凑而不是漂亮的输出<span class="token punctuation">;</span>
-n               使用<span class="token variable"><span class="token variable">`</span>null<span class="token variable">`</span></span>作为单个输入值<span class="token punctuation">;</span>
-e               根据输出设置退出状态代码<span class="token punctuation">;</span>
-s               将所有输入读取（吸取）到数组中；应用过滤器<span class="token punctuation">;</span>
-r               输出原始字符串，而不是JSON文本<span class="token punctuation">;</span>
-R               读取原始字符串，而不是JSON文本<span class="token punctuation">;</span>
-C               为JSON着色<span class="token punctuation">;</span>
-M               单色（不要为JSON着色）<span class="token punctuation">;</span>
-S               在输出上排序对象的键<span class="token punctuation">;</span>
--tab            使用制表符进行缩进<span class="token punctuation">;</span>
--arg a <span class="token function">v</span>        将变量<span class="token variable">$a</span>设置为value<span class="token operator">&#x3C;</span>v<span class="token operator">></span><span class="token punctuation">;</span>
--argjson a <span class="token function">v</span>    将变量<span class="token variable">$a</span>设置为JSON value<span class="token operator">&#x3C;</span>v<span class="token operator">></span><span class="token punctuation">;</span>
--slurpfile a f  将变量<span class="token variable">$a</span>设置为从<span class="token operator">&#x3C;</span>f<span class="token operator">></span>读取的JSON文本数组<span class="token punctuation">;</span>
--rawfile a f    将变量<span class="token variable">$a</span>设置为包含<span class="token operator">&#x3C;</span>f<span class="token operator">></span>内容的字符串<span class="token punctuation">;</span>
--args           其余参数是字符串参数，而不是文件<span class="token punctuation">;</span>
--jsonargs       其余的参数是JSON参数，而不是文件<span class="token punctuation">;</span>
--               终止参数处理<span class="token punctuation">;</span>
</code></pre>
<h3 id="例子"><a href="#%E4%BE%8B%E5%AD%90" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>例子</h3>
<p><code>.</code>: 以漂亮的方式输出</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'{ "foo": { "bar": { "baz": 123 } } }'</span> <span class="token operator">|</span> jq <span class="token string">'.'</span>
<span class="token punctuation">{</span>
  <span class="token string">"foo"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">"bar"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">"baz"</span><span class="token builtin class-name">:</span> <span class="token number">123</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<p><code>.foo, .foo.bar, .foo?</code>: 获取一个键的值</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'{"foo": 42, "bar": "less interesting data"}'</span> <span class="token operator">|</span> jq <span class="token string">'.foo'</span>
<span class="token number">42</span>
</code></pre>
<p><code>.[], .[]?, .[2], .[10:15]</code>: 数组运算</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'[{"name":"JSON", "good":true}, {"name":"XML", "good":false}]'</span> <span class="token operator">|</span> jq <span class="token string">'.[1]'</span>
<span class="token punctuation">{</span>
  <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"XML"</span>,
  <span class="token string">"good"</span><span class="token builtin class-name">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

</code></pre>
<p><code>[], {}</code>: 构造一个数组/对象</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'{"user":"stedolan","titles":["JQ Primer", "More JQ"]}'</span> <span class="token operator">|</span> jq <span class="token string">'{user, title: .titles[]}'</span>

<span class="token punctuation">{</span>
  <span class="token string">"user"</span><span class="token builtin class-name">:</span> <span class="token string">"stedolan"</span>,
  <span class="token string">"title"</span><span class="token builtin class-name">:</span> <span class="token string">"JQ Primer"</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token string">"user"</span><span class="token builtin class-name">:</span> <span class="token string">"stedolan"</span>,
  <span class="token string">"title"</span><span class="token builtin class-name">:</span> <span class="token string">"More JQ"</span>
<span class="token punctuation">}</span>

</code></pre>
<p><code>length</code>: 计算一个值的长度</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'[[1,2], "string", {"a":2}, null]'</span> <span class="token operator">|</span> jq <span class="token string">'.[] | length'</span>                                  
<span class="token number">2</span>
<span class="token number">6</span>
<span class="token number">1</span>
<span class="token number">0</span>

</code></pre>
<p><code>keys</code>: 取出数组中的键</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'{"abc": 1, "abcd": 2, "Foo": 3}'</span> <span class="token operator">|</span> jq <span class="token string">'keys'</span>                                        
<span class="token punctuation">[</span>
  <span class="token string">"Foo"</span>,
  <span class="token string">"abc"</span>,
  <span class="token string">"abcd"</span>
<span class="token punctuation">]</span>

</code></pre>
<p><code>,</code>: 使用多个过滤器</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'{ "foo": 42, "bar": "something else", "baz": true}'</span> <span class="token operator">|</span> jq <span class="token string">'.foo, .bar'</span> 
<span class="token number">42</span>
<span class="token string">"something else"</span>

</code></pre>
<p><code>|</code>: 通过管道将一个过滤器的输出当做下一个过滤器的输入</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'[{"name":"JSON", "good":true}, {"name":"XML", "good":false}]'</span> <span class="token operator">|</span> jq <span class="token string">'.[] | .name'</span>                                                 
<span class="token string">"JSON"</span>
<span class="token string">"XML"</span>

</code></pre>
<p><code>select(foo)</code>: 如果foo返回true，则输入保持不变</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'[1,5,3,0,7]'</span> <span class="token operator">|</span> jq <span class="token string">'map(select(. >= 2))'</span>                                                    
<span class="token punctuation">[</span>
  <span class="token number">5</span>,
  <span class="token number">3</span>,
  <span class="token number">7</span>
<span class="token punctuation">]</span>

</code></pre>
<p><code>map(foo)</code>: 每个输入调用过滤器</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'[1,2,3]'</span> <span class="token operator">|</span> jq <span class="token string">'map(.+1)'</span>
<span class="token punctuation">[</span>
  <span class="token number">2</span>,
  <span class="token number">3</span>,
  <span class="token number">4</span>
<span class="token punctuation">]</span>

</code></pre>
<p><code>if-then-else-end</code>: 条件判断</p>
<pre class="language-bash"><code class="language-bash"> $ <span class="token builtin class-name">echo</span> <span class="token string">'2'</span> <span class="token operator">|</span> jq <span class="token string">'if . == 0 then "zero" elif . == 1 then "one" else "many" end'</span>

<span class="token string">"many"</span>

</code></pre>
<p><code>\(foo)</code>: 在字符串中插入值并进行运算</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'42'</span> <span class="token operator">|</span> jq <span class="token string">'"The input was \(.), which is one less than \(.+1)"'</span>          

<span class="token string">"The input was 42, which is one less than 43"</span>

</code></pre>
<!-- Linux命令行搜索引擎：https://jaywcjlove.github.io/linux-command/ -->
</div>

<div class="footer  footer_index "><a href="../hot.html">Linux 命令列表</a></div><script type="text/javascript" src="../js/dt.js?v=1628823324531"></script><script type="text/javascript" src="../js/index.js?v=1628823324531"></script></body></html>